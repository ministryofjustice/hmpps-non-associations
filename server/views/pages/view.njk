{% extends "../partials/layout.njk" %}

{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/table/macro.njk" import govukTable %}

{% set pageTitle = prisonerName | possessiveName + " non-associations" %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column">

      <span class="govuk-caption-l">Non-associations</span>
      <h1 class="govuk-heading-l">
        {{ prisonerName | possessiveName}} non-associations
      </h1>
      <p class="govuk-!-text-align-right">
      {{ govukButton({
        text: "Add new non-association",
        element: "a",
        href: routeUrls.prisonerSearch(prisonerNumber)
      }) }}
      </p>

        {% set tableRows = [] %}
        {% for nonAssociation in nonAssociations %}

          {% set otherPrisonerProfileLink %}
          <a href="{{ dpsUrl }}/prisoner/{{ nonAssociation.otherPrisonerNumber }}" data-ga-category="Reviews table > Clicked on link" data-ga-action="prisoner name">
           <span class="govuk-visually-hidden">
                    View prisoner profile for
                  </span>
            <strong>{{ nonAssociation.otherPrisonerName }}</strong>
            <br />
            {{ nonAssociation.otherPrisonerNumber }}
            </a>
          {% endset %}

          {% set reason %}
            {{ nonAssociation.reason}}
          {% endset %}

          {% set whereToKeepApart %}
            {{ nonAssociation.whereToKeepApart}}
          {% endset %}

          {% set comments %}
            {{ nonAssociation.comments}}
          {% endset %}

          {% set dateAdded %}
            {{ nonAssociation.dateAdded}}
          {% endset %}




          {% set tableRows = (tableRows.push([
            {html: otherPrisonerName},
            {html: otherPrisonerProfileLink},
            {html: reason},
            {html: whereToKeepApart},
            {html: comments},
            {html: dateAdded}
          ]), tableRows) %}
        {% endfor %}

        {% set caption -%}
         Non Associations for  {{ prisonerName }}
        {%- endset %}
        <div class="app-sortable-table">
          {{ govukTable({
            caption: caption,
            captionClasses: "govuk-visually-hidden",
            classes: "app-sortable-table-container",
            head: tableHead,
            rows: tableRows
          }) }}
        </div>

    </div>
  </div>
{% endblock %}

{% extends "../partials/layout.njk" %}

{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/table/macro.njk" import govukTable %}
{% from "govuk/components/pagination/macro.njk" import govukPagination %}

{% set pageTitle = prisonerName | possessiveName + " non-associations" %}

{% block content %}

  <span class="govuk-caption-l">Non-associations</span>
  <h1 class="govuk-heading-l">
    {{ prisonerName | possessiveName}} non-associations
  </h1>
  <p class="govuk-!-text-align-right">
    {{ govukButton({
      text: "Add new non-association",
      element: "a",
      href: routeUrls.prisonerSearch(prisonerNumber)
    }) }}
  </p>

  {% if nonAssociations.length > 0 %}

  {% set tableRows = [] %}
  {% for nonAssociation in nonAssociations %}

    {% set otherPrisonerPhoto %}
      <img src="{{ routeUrls.prisonerPhoto(nonAssociation.otherPrisonerNumber) }}" alt="Photo of {{ nonAssocociation.otherPrisonerName }}" class="app-prisoner-photo" />
    {% endset %}

    {% set otherPrisonerProfileLink %}
      <a href="{{ dpsUrl }}/prisoner/{{ nonAssociation.otherPrisonerNumber }}">
        <span class="govuk-visually-hidden"> View prisoner profile for </span>
        <strong>{{ nonAssociation.otherPrisonerName }}</strong>
        <br />
        {{ nonAssociation.otherPrisonerNumber }}
      </a>
    {% endset %}

    {% set reason %}
      {{ nonAssociation.reason}}
    {% endset %}

    {% set role %}
      {{ nonAssociation.role}}
    {% endset %}

    {% set whereToKeepApart %}
      {{ nonAssociation.whereToKeepApart}}
    {% endset %}

    {% set comments %}
      {{ nonAssociation.comments}}
    {% endset %}

    {% set dateAdded %}
      {{ nonAssociation.dateAdded}}
    {% endset %}

    {% set tableRows = (tableRows.push([
      {html: otherPrisonerPhoto},
      {html: otherPrisonerProfileLink},
      {html: reason},
      {html: role},
      {html: whereToKeepApart},
      {html: comments},
      {html: dateAdded}
    ]), tableRows) %}
  {% endfor %}

  {% set caption -%}
    Non Associations for  {{ prisonerName }}
  {%- endset %}

  <div class="app-sortable-table-container">
    {{ govukTable({
      caption: caption,
      captionClasses: "govuk-visually-hidden",
      classes: "app-sortable-table",
      head: [
        {html: "<span class=\"govuk-visually-hidden\">Photo</span>"},
        {html: 'Prisoner'},
        {html: 'Reason'},
        {html: 'Role'},
        {html: 'Where&nbsp;to&nbsp;keep apart'},
        {html: 'Comments'},
        {html: 'Date added'}
      ],
      rows: tableRows
    }) }}
  </div>

  {% if paginationParams %}
    <div class="app-pagination-right-aligned">
       {{ govukPagination(paginationParams) }}
    </div>
  {% endif %}

  {% else %}

    <p>{{ prisonerName }} has no Non Associations
    </p>

  {% endif %}

{% endblock %}
